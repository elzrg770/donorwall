<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Donor Wall – Fan Layout</title>
  <link rel="stylesheet" href="style.css">

  <style>
    body {
      margin:0;
      padding:2rem 1rem;
      /*font-family:Georgia,serif;*/
      font-family: sans-serif;
      background:#0e1b2c;
      color:#fff;
      text-align:center;
    }
    h1{margin-bottom:3rem;font-size:2.4rem}
    #donor-wall{display:flex;flex-direction:column;align-items:center;gap:22px;max-width:1100px;margin:0 auto;}
    .tier-row{display:flex;justify-content:center;gap:18px;flex-wrap:nowrap;}
    .plaque{width:120px;height:60px;border-radius:50%/50%;display:flex;flex-direction:column;align-items:center;justify-content:center;font-weight:600;font-size:0.95rem;box-shadow:0 0 6px rgba(0,0,0,.4);padding:4px;text-align:center;}
    .plaque span.amount{font-size:0.75em;font-style:italic;font-weight:400;}
    .top{background:linear-gradient(#ffd700,#ffc20e);color:#000}
    .middle{background:linear-gradient(#f1f1f1,#bfc7d1);color:#000}
    /*.bottom{background:linear-gradient(#c97c37,#8d6449);color:#fff}*/
    .bottom {
    background: linear-gradient(#ef8f39, #e6945e);
    color: #000;
}
  </style>
</head>
<body>
  <h1>Chai Club Members</h1>
  <div id="donor-wall">Loading donors…</div>

<script>
const CSV_FILE = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSgtQMdzrtymc-gPKeDZET-ynYo_DDCL-icYNJ7EGOWP-TjhRXiAUUhmvjvNN7P7_L9kjC4QbNcTd-f/pub?gid=0&single=true&output=csv";

async function fetchDonors(url){
  const res = await fetch(url);
  const txt = await res.text();
  const lines = txt.trim().split('\n');
  const headers = lines[0].split(',').map(h=>h.trim().toLowerCase());
  const iName = headers.indexOf('name'),
        iAmt  = headers.indexOf('amount'),
        iTier = headers.indexOf('tier'),
        iLogo = headers.indexOf('logo');

  let logoURL = null;
  const donors = [];

  for(let i=1; i<lines.length; i++){
    const cols = lines[i].split(',');
    const name   = cols[iName]?.trim();
    const amount = +cols[iAmt] || 0;
    const tier   = cols[iTier]?.trim().toLowerCase();
    const logo   = cols[iLogo]?.trim();

    // — capture first non‐empty logo URL
    if(logo && !logoURL){
      logoURL = logo.replace(/dl=0$/,'raw=1');
    }

    if(name && tier){
      donors.push({ name, amount, tier });
    }
  }

  return { donors, logoURL };
}

function tierOf(d){
  return d.amount >= 5000 ? 'top'
       : d.amount >= 1000 ? 'middle'
       : 'bottom';
}

function createPlaque(d){
  // — insert your <span class="amount"> here
  const p = document.createElement('div');
  p.className = 'plaque ' + tierOf(d);
  p.innerHTML = `
    ${d.name}
    <span class="amount">${d.amount.toLocaleString()}</span>
  `;
  return p;
}

function render(donors, logoURL){
  const wall = document.getElementById('donor-wall');
  wall.innerHTML = '';

  // reproduce your old logic, but swap in dynamic logoURL
  ['top','middle','bottom'].forEach(tierKey => {
    const group = donors.filter(d => d.tier === tierKey);

    // heading etc. (unchanged)
    const h2 = document.createElement('h2');
    h2.textContent = { top:'Gold', middle:'Silver', bottom:'Bronze' }[tierKey];
    wall.appendChild(h2);

    // your original “middle” layout (static two‐column + logo)
    if(tierKey === 'middle'){
      const wrap = document.createElement('div');
      wrap.className = 'middle-tier-wrap';
      /* …your existing column + row code… */

      // *** only change here: ***
      const img = document.createElement('img');
      img.src  = logoURL || 'club.png';
      img.alt  = 'Center Logo';
      /* …rest of your img styling… */

      wrap.appendChild(img);
      wall.appendChild(wrap);

    } else {
      // your original distribute rows for top/bottom
      /* …unchanged… */
    }
  });
}

// wire it up, passing logoURL through to render
fetchDonors(CSV_FILE)
  .then(({ donors, logoURL }) => render(donors.map(d=>({ ...d, tier:tierOf(d) })), logoURL))
  .catch(e => {
    document.getElementById('donor-wall').textContent = 'Error loading data.';
    console.error(e);
  });
</script>

</body>
</html>
