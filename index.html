
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Donor Wall</title>
  <style>
    body {
      margin: 0;
      padding: 2rem 1rem;
      font-family: sans-serif;
      background: #0e1b2c;
      color: #fff;
      text-align: center;
    }
    h1 {
      margin-bottom: 3rem;
      font-size: 2.4rem;
    }
    #donor-wall {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 22px;
      max-width: 1100px;
      margin: 0 auto;
    }
    .tier-row {
      display: flex;
      justify-content: center;
      gap: 18px;
      flex-wrap: nowrap;
    }
    .plaque {
      width: 120px;
      height: 60px;
      border-radius: 50%/50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.95rem;
      box-shadow: 0 0 6px rgba(0,0,0,.4);
      padding: 4px;
      text-align: center;
    }
    .top {
      background: linear-gradient(#ffd700,#ffc20e);
      color: #000;
    }
    .middle {
      background: linear-gradient(#f1f1f1,#bfc7d1);
      color: #000;
    }
    .bottom {
      background: linear-gradient(#ef8f39, #e6945e);
      color: #000;
    }
  </style>
</head>
<body>
  <h1>Chai Club Members</h1>
  <div id="donor-wall">Loading donors…</div>

  <script>
    const CSV_FILE = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSgtQMdzrtymc-gPKeDZET-ynYo_DDCL-icYNJ7EGOWP-TjhRXiAUUhmvjvNN7P7_L9kjC4QbNcTd-f/pub?gid=0&single=true&output=csv";

    const TIERS = {
      gold:   { rows:[3,4,5,6,7] },
      silver: { rows:[4,5,6,5,4] },
      bronze: { rows:[9,8,7,6,5,4] }
    };

    async function fetchDonors(url){
      const res = await fetch(url);
      const txt = await res.text();
      const lines = txt.trim().split('\n');
      const headers = lines[0].split(',').map(h => h.trim().toLowerCase());

      const nameIndex = headers.indexOf('name');
      const tierIndex = headers.indexOf('tier');
      const logoIndex = headers.indexOf('logo');

      let logoURL = null;
      const donors = [];

      for (let i = 1; i < lines.length; i++) {
        const cols = lines[i].split(',');
        const name = cols[nameIndex]?.trim();
        const tier = cols[tierIndex]?.trim().toLowerCase();
        const logo = cols[logoIndex]?.trim();

        if (logo && !logoURL) logoURL = logo.replace("dl=0", "raw=1");

        if (name && tier) donors.push({ name, tier });
      }

      return { donors, logoURL };
    }

    function distribute(list, tierKey){
      const pattern = TIERS[tierKey].rows;
      const rows = pattern.map(() => []);
      let i = 0;
      list.forEach(d => {
        while(i < rows.length && rows[i].length >= pattern[i]) i++;
        (rows[i] || rows[rows.length-1]).push(d);
      });
      return rows;
    }

   function createPlaque(d, tier){
  const tierMap = {
    gold: 'top',
    silver: 'middle',
    bronze: 'bottom'
  };
  const p = document.createElement('div');
  p.className = 'plaque ' + (tierMap[tier] || 'bottom');
  p.textContent = d.name;
  return p;
}


    function render(donors, logoURL) {
      const wall = document.getElementById('donor-wall');
      wall.innerHTML = '';

      const tierLabels = {
        gold: 'Gold',
        silver: 'Silver',
        bronze: 'Bronze'
      };

      ['gold', 'silver', 'bronze'].forEach(tier => {
        const group = donors.filter(d => d.tier === tier);

       // const heading = document.createElement('h2');
       // heading.textContent = tierLabels[tier];
       // heading.style.textAlign = 'center';
       // heading.style.marginTop = '2rem';
       // wall.appendChild(heading);

        if (tier === 'silver') {
          const wrap = document.createElement('div');
          wrap.className = 'middle-tier-wrap';
          Object.assign(wrap.style, {
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'flex-start',
            gap: '30px',
            flexWrap: 'nowrap',
            margin: '2rem 0'
          });

          const makeColumn = () => {
            const col = document.createElement('div');
            col.style.display = 'flex';
            col.style.flexDirection = 'column';
            col.style.gap = '18px';
            return col;
          };
          const leftCol = makeColumn();
          const rightCol = makeColumn();

          const half = Math.ceil(group.length / 2);
          const sides = [group.slice(0, half), group.slice(half)];

          sides.forEach((sideList, idx) => {
            const col = idx === 0 ? leftCol : rightCol;
            for (let i = 0; i < sideList.length; i += 3) {
              const rowEl = document.createElement('div');
              rowEl.className = 'tier-row';
              sideList.slice(i, i + 3)
                      .forEach(d => rowEl.appendChild(createPlaque(d, tier)));
              col.appendChild(rowEl);
            }
          });

          const img = document.createElement('img');
          img.src  = logoURL || 'club.png';
          img.alt  = 'Center Logo';
          img.style.width  = '300px';
          img.style.height = '300px';
          img.style.flexShrink = '0';

          wrap.appendChild(leftCol);
          wrap.appendChild(img);
          wrap.appendChild(rightCol);
          wall.appendChild(wrap);
        } else {
          const rows = distribute(group, tier);
          rows.forEach(r => {
            const rowEl = document.createElement('div');
            rowEl.className = 'tier-row';
            r.forEach(d => rowEl.appendChild(createPlaque(d, tier)));
            wall.appendChild(rowEl);
          });
        }
           // Render logo at the bottom (mobile only)
      if (logoURL) {
        const logo = document.createElement('img');
        logo.src = logoURL;
        logo.alt = 'Logo';
        logo.className = 'mobile-logo';
        logo.style.margin = '2rem auto 0 auto';
        logo.style.display = 'block';
        logo.style.width = '200px';
        logo.style.height = 'auto';
        wall.appendChild(logo);
      }
    } // ✅ closes render()

    fetchDonors(CSV_FILE)
      .then(({ donors, logoURL }) => render(donors, logoURL))
      .catch(e => {
        document.getElementById('donor-wall').textContent = 'Error loading data.';
        console.error(e);
      });
  </script>
</body>
</html>
